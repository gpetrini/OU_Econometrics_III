<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-09-22 ter 19:01 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dynamic Discrete Choice Models (DDC)</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Gabriel Petrini" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Dynamic Discrete Choice Models (DDC)</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org25ec0a3">1. Reading Quiz</a></li>
<li><a href="#org3321e52">2. Optimal Stopping Problems</a>
<ul>
<li><a href="#org23e8ed4">2.1. Examples of optimal stopping problems</a></li>
<li><a href="#orgae26abe">2.2. Mathematics of optimal stopping</a></li>
</ul>
</li>
<li><a href="#orgb1e0e02">3. Finite Horizon Problems</a>
<ul>
<li><a href="#orgb31eaaa">3.1. Expectations and assumptions</a></li>
<li><a href="#org1881fae">3.2. Two-period example</a></li>
<li><a href="#orgc508653">3.3. When Dynamics Don't Matter</a></li>
<li><a href="#org9c68da4">3.4. Finite Horizon Dynamics</a></li>
<li><a href="#orgfe96e9d">3.5. Stochastic \(X\)'s</a></li>
<li><a href="#org79b55d5">3.6. Choice Probabilities</a></li>
<li><a href="#orgc3fb62d">3.7. Estimation</a></li>
</ul>
</li>
<li><a href="#orge810391">4. Infinite Horizon Problems</a>
<ul>
<li><a href="#org231466e">4.1. Optimal stopping in (<a href="#citeproc_bib_item_1">Rust 1987</a>)</a></li>
<li><a href="#orgfade07a">4.2. Estimation</a></li>
<li><a href="#orgd4726b0">4.3. Nested Fixed Point (NFXP) Algorithm</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org25ec0a3" class="outline-2">
<h2 id="org25ec0a3"><span class="section-number-2">1</span> Reading Quiz</h2>
</div>

<div id="outline-container-org3321e52" class="outline-2">
<h2 id="org3321e52"><span class="section-number-2">2</span> Optimal Stopping Problems</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org23e8ed4" class="outline-3">
<h3 id="org23e8ed4"><span class="section-number-3">2.1</span> Examples of optimal stopping problems</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Many economic problems involve some sort of optimal stopping:
</p>
<ul class="org-ul">
<li>The Secretary Problem (when to hire from a sequence of job candidates)</li>
<li>Seach theory more generally (job search, spousal search, house search, &#x2026;)</li>
<li>"Buy/sell/hold" problems (e.g. stock/options trading)</li>
<li>Replacement problems (e.g. infrastructure)</li>
</ul>

<p>
Optimal stopping problems inherently have a tension between costs and benefits:
</p>

<ul class="org-ul">
<li>It is costly to interview job candidates</li>
<li>But it is also costly to miss out on the best candidate</li>
</ul>
</div>
</div>


<div id="outline-container-orgae26abe" class="outline-3">
<h3 id="orgae26abe"><span class="section-number-3">2.2</span> Mathematics of optimal stopping</h3>
<div class="outline-text-3" id="text-2-2">
<p>
In a discrete choice setting, <b>dynamic programming</b> is the best solution method
</p>

<ul class="org-ul">
<li>Within a discrete choice setting, time can be either continuous or discrete
<ul class="org-ul">
<li>If continuous time, use Hamiltonians and Differential Equations</li>
<li>If discrete time, use recursive methods</li>
</ul></li>
</ul>

<p>
Solution method also depends on the time horizon
</p>

<ul class="org-ul">
<li>If the time horizon is finite, then we can use dynamic programming</li>
<li>If the time horizon is infinite, then need to (also) solve for a fixed point</li>
</ul>

<p>
We will discuss these details today
</p>
</div>
</div>
</div>


<div id="outline-container-orgb1e0e02" class="outline-2">
<h2 id="orgb1e0e02"><span class="section-number-2">3</span> Finite Horizon Problems</h2>
<div class="outline-text-2" id="text-3">
<p>
Individual \(i\)'s <b>flow utility</b> for option \(j\) at time \(t\) is:
</p>
\begin{align*}
U_{ijt}&=u_{ijt}+\epsilon_{ijt}\\
&=X_{it}\alpha_j+\epsilon_{ijt}
\end{align*}

<ul class="org-ul">
<li>\(i\) chooses \(d_{it}\) to maximize her <b>expected lifetime utility</b></li>
</ul>

\begin{align*}
\max \mathbb{E}\sum_{\tau=t}^T\sum_{j}\beta^{\tau-t}1\left[d_{it}=j\right]U_{ijt}\left(X_{it},\epsilon_{ijt}\right)
\end{align*}
</div>

<div id="outline-container-orgb31eaaa" class="outline-3">
<h3 id="orgb31eaaa"><span class="section-number-3">3.1</span> Expectations and assumptions</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>\(i\) takes expectations over \(X\)'s (future states) and \(\epsilon\)'s (future errors)</li>
<li>\(\epsilon\)'s are assumed to be iid over time</li>
<li>Future states are not affected by \(\epsilon\)'s except through choices:</li>
</ul>

\begin{align*}
\mathbb{E}(X_{t+1}|d_t,...,d_1,\epsilon_t,...,\epsilon_{1})&=\mathbb{E}(X_{t+1}|d_t,...,d_1)
\end{align*}
</div>
</div>

<div id="outline-container-org1881fae" class="outline-3">
<h3 id="org1881fae"><span class="section-number-3">3.2</span> Two-period example</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Consider the utility of choice \(j\) in the last period:
</p>
\begin{align*}
U_{ijT}&=u_{ijT}+\epsilon_{ijT}\\
&=X_{iT}\alpha_j+\epsilon_{ijT}
\end{align*}

<p>
Define the <b>conditional valuation function</b> for choice \(j\) as the flow utility of \(j\) minus the associated \(\epsilon\) plus the expected value of future utility conditional on \(j\):
</p>
\begin{align*}
v_{ijT-1}&=u_{ijT-1}+\beta \mathbb{E}\max_{k\in J}\left\{u_{ikT}+\epsilon_{ikT}|d_{iT-1}=j\right\}
\end{align*}
<p>
where \(\beta\) is the discount factor
</p>
<ul class="org-ul">
<li>Suppose \(X_{iT}\) was deterministic given \(X_{iT-1}\) and \(d_{iT-1}\) and the \(\epsilon\)'s are T1EV</li>
<li>What would the \(\mathbb{E}\max\) expression be?</li>
</ul>
</div>
</div>

<div id="outline-container-orgc508653" class="outline-3">
<h3 id="orgc508653"><span class="section-number-3">3.3</span> When Dynamics Don't Matter</h3>
<div class="outline-text-3" id="text-3-3">
<p>
As in static models, we need to normalize with respect to some alternative
</p>

<ul class="org-ul">
<li>Suppose we normalize with respect to \(j'\):</li>
</ul>
\begin{align*}
v_{ijT-1}-v_{ij'T-1}&=u_{ijT-1}+\beta \mathbb{E}\max_{k\in J}\left\{u_{ikT}+\epsilon_{ikT}|d_{iT-1}=j\right\}-\\
&\phantom{\text{-}-}u_{ij'T-1}-\beta \mathbb{E}\max_{k\in J}\left\{u_{ikT}+\epsilon_{ikT}|d_{iT-1}=j'\right\}
\end{align*}

<p>
If the two expected future value terms are equal, we get a cancellation
</p>

<p>
\(\implies\) choices have to (at least probabilistically) affect the future states
</p>

<ul class="org-ul">
<li>The simplest way to satisfy this condition is to have <b>switching costs</b> in the model</li>
<li>Intuition: switching costs make one think carefully about changing course</li>
</ul>
</div>
</div>

<div id="outline-container-org9c68da4" class="outline-3">
<h3 id="org9c68da4"><span class="section-number-3">3.4</span> Finite Horizon Dynamics</h3>
<div class="outline-text-3" id="text-3-4">
<p>
In period \(T-1\) we have:
</p>
\begin{align*}
v_{ijT-1}=u_{ijT-1}+\beta \mathbb{E}\max_{k\in J}\left\{u_{ikT}+\epsilon_{ikT}|d_{iT-1}=j\right\}
\end{align*}
<p>
Rolling back one more period,
</p>
\begin{align*}
v_{ijT-2}=u_{ijt}+\beta \mathbb{E}\max_{k\in J}\left\{v_{ikT-1}+\epsilon_{ikT-1}|d_{iT-2}=j\right\}
\end{align*}
<p>
Keep going back and the \(\mathbb{E}\max\) operator can always be expressed as functions of the next period conditional value functions:
</p>
\begin{align*}
v_{ijt}=u_{ijT-2}+\beta \mathbb{E}\max_{k\in J}\left\{v_{ikt+1}+\epsilon_{ikt+1}|d_{it}=j\right\}
\end{align*}

<p>
Another name for \(\max_{k\in J}\left\{v_{ikt+1}+\epsilon_{ikt+1}\right\}\) is&#x2026;.
</p>
</div>
</div>

<div id="outline-container-orgfe96e9d" class="outline-3">
<h3 id="orgfe96e9d"><span class="section-number-3">3.5</span> Stochastic \(X\)'s</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Let \(f_{jt}(X_{it+1}|X_{it})\) be the pdf associated with moving from \(X_{it}\) to \(X_{it+1}\) given choice \(j\) at time \(t\) 
</p>

<p>
<b>Example:</b> suppose we were interested in Covid on OU's campus. The choice set is {close campus, open campus but online classes, in-person classes}. The transitions on the \(X\)'s would be the Covid case (or fatality) counts associated with each of the choices. 
</p>

<p>
Since these Covid case probabilities do not depend on the \(\epsilon\)'s, it is convenient to integrate them out of the future utility term
</p>

<p>
The conditional value function is then:
</p>
\begin{align*}
v_{jt}(X_{it})&=u_{jt}(X_{it})+\beta \int_{X_{it+1}}\mathbb{E}_{\epsilon}\left\{\max_{k\in J} v_{kt+1}(X_{it+1})+\epsilon_{ikt+1}\right\}dF_{jt}(X_{it+1}|X_{it})
\end{align*}


<p>
If the \(\epsilon\)'s are distributed Type 1 extreme value, what is the expression for the conditional value function? What about the general GEV case? We can then start at the last period and work our way backwards to obtain all of the relevant conditional value functions
</p>
</div>
</div>

<div id="outline-container-org79b55d5" class="outline-3">
<h3 id="org79b55d5"><span class="section-number-3">3.6</span> Choice Probabilities</h3>
<div class="outline-text-3" id="text-3-6">
<p>
The choice probabilities are then calculated in the same way as in the static case
</p>

<ul class="org-ul">
<li>The only difference is now we use \(v\)'s instead of \(u\)'s</li>
<li>In the multinomial logit case we have:</li>
</ul>

\begin{align*}
p_{jt}(X_{it})&=\frac{\exp(v_{jt}(X_{it}))}{\sum_{k\in J}\exp(v_{kt}(X_{it}))}
\end{align*}
</div>
</div>

<div id="outline-container-orgc3fb62d" class="outline-3">
<h3 id="orgc3fb62d"><span class="section-number-3">3.7</span> Estimation</h3>
<div class="outline-text-3" id="text-3-7">
<p>
The likelihood of the data is:
</p>

\begin{align*}
\mathcal{L}(\alpha,\beta,\gamma)&=\prod_i\prod_t\prod_j\left[p_{jt}(X_{it},\alpha,\beta,\gamma)f_{jt}(X_{it+1}|X_it,\gamma)\right]^{d_{it}=j}
\end{align*}
<p>
where \(\gamma\) governs the transitions of the \(X\)'s
</p>

<p>
The log likelihood is then given by:
</p>
\begin{align*}
\ell(\alpha,\beta,\gamma)&=\sum_i\sum_t\sum_j (d_{it}=j)\left\{\ln[p_{jt}(X_{it},\alpha,\beta,\gamma)]+\ln[f_{jt}(X_{it+1}|X_it,\gamma)]\right\}
\end{align*}

<p>
Since the log likelihood function is additively separable, we can estimate \(\gamma\) in a first stage
</p>
</div>
</div>
</div>


<div id="outline-container-orge810391" class="outline-2">
<h2 id="orge810391"><span class="section-number-2">4</span> Infinite Horizon Problems</h2>
<div class="outline-text-2" id="text-4">
\begin{align*}
v_{j}(X_{i})&=u_{j}(X_{i})+\beta \int_{X'}V(X')dF_{j}(X'|X_{i})\\
&=u_{j}(X_{i})+\beta \int_{X'}E_{\epsilon'}\left(\max_{k\in J} v_{k}(X')+\epsilon'_{ik}\right)dF_{j}(X'|X_{i})\\
\end{align*}
<p>
which in the Type 1 extreme value case for the \(\epsilon\)'s yields:
</p>

\begin{align*}
v_j(X_i)=u_j(X_i)+\beta\int_{X'}\ln\left(\sum_{k\in J}\exp[v_{k}(X')]\right)dF_j(X'|X_i)+\beta c
\end{align*}

<p>
Now, stack the conditional value functions for each possible state and choice. Because the \(v\)'s are on both sides of the stacked equations, we need to solve for a fixed point (This works because it is a contraction mapping).
</p>

<p>
Let \(\mathcal{X}\) denote the number of states \(X\) can take on
</p>

<p>
The stacked equations are then:
</p>

\begin{align*}
\left[\begin{array}{c}v_1(X_1)\\
v_1(X_2)\\
\vdots \\ 
v_1(X_{\mathcal{X}})\\
\vdots\\
 v_{J}(X_{\mathcal{X}})\end{array}\right]=
\left[\begin{array}{c}u_1(X_1)+\beta\int_{X'}\ln\left(\sum_{k\in J}\exp[v_{k}(X')]\right)dF_1(X'|X_1)+\beta c\\
u_1(X_2)+\beta\int_{X'}\ln\left(\sum_{k\in J}\exp[v_{k}(X')]\right)dF_1(X'|X_2)+\beta c\\
\vdots\\
u_1(X_{\mathcal{X}})+\beta\int_{X'}\ln\left(\sum_{k\in J}\exp[v_{k}(X')]\right)dF_1(X'|X_{\mathcal{X}})+\beta c\\
\vdots\\
u_J(X_{\mathcal{X}})+\beta\int_{X'}\ln\left(\sum_{k\in J}\exp[v_{k}(X')]\right)dF_J(X'|X_{\mathcal{X}})+\beta c\\
\end{array}\right]
\end{align*}

<ul class="org-ul">
<li>Plug in values for the parameters and take a guess at the \(v\)'s</li>
<li>Substitute in for the \(v\)'s on the right hand side which gives us a new set of \(v\)'s</li>
<li>Repeat until convergence</li>
</ul>
</div>

<div id="outline-container-org231466e" class="outline-3">
<h3 id="org231466e"><span class="section-number-3">4.1</span> Optimal stopping in (<a href="#citeproc_bib_item_1">Rust 1987</a>)</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Rust analyzes the decision to replace a bus engine \((d=1)\) or not \((d=0)\). How is this an optimal stopping problem?
</p>

<ul class="org-ul">
<li>The maintenance superintendent (<a href="https://twitter.com/haroldzurcher87">Harold Zurcher</a>) wants to minimize costs</li>
<li>But he also doesn't want buses to break down while in service</li>
<li>Premature replacement can be very costly, but so is in-service breakdown</li>
<li>The goal is then to figure out when to optimally replace engines</li>
<li>Especially when some buses might happen to get driven more than others</li>
</ul>

<p>
Replacement decision depends upon the mileage on the engine, \(x\), the cost of replacing the engine \(\overline{P}\) and the scrap value of the current engine \(\underline{P}\) 
</p>

<ul class="org-ul">
<li>The payoffs net of the error term are given by:</li>
</ul>
\begin{align*}
u_0(x_i,\theta)&=-c(x_i,\theta)\\
u_1(x_i,\theta)&=-[\overline{P}-\underline{P}+c(0,\theta)]
\end{align*}

<ul class="org-ul">
<li>Mileage is discrete and transitions according to some process \(f(x_{t+1}|x_t)\)</li>

<li>Example: some probability of staying at the current mileage, some probability of moving up one mileage state and some probability of moving up two mileage states</li>
</ul>
</div>
</div>

<div id="outline-container-orgfade07a" class="outline-3">
<h3 id="orgfade07a"><span class="section-number-3">4.2</span> Estimation</h3>
<div class="outline-text-3" id="text-4-2">
<ol class="org-ol">
<li>Calculate the mileage transitions, i.e. get  \(f(x_{t+1}|x_t)\)</li>

<li>Maximize the log likelihood of the choices:</li>
</ol>
\begin{align*}
\ell(\theta)=\sum_i\sum_t \sum_j (d_{it}=j)\ln(p_{jt}(x_{it},\theta))
\end{align*}

<ol class="org-ol">
<li>Within the maximization routine, solve a fixed point problem in the \(v\)'s each time the log likelihood function is evaluated</li>

<li>For your problem set, I'll walk you through how to estimate a model similar to Rust's</li>
</ol>
</div>
</div>

<div id="outline-container-orgd4726b0" class="outline-3">
<h3 id="orgd4726b0"><span class="section-number-3">4.3</span> Nested Fixed Point (NFXP) Algorithm</h3>
<div class="outline-text-3" id="text-4-3">
<p>
<a href="https://editorialexpress.com/jrust/nfxp.html">Nested Fixed Point (NFXP) Algorithm</a>
</p>


<style>.csl-entry{text-indent: -1.5em; margin-left: 1.5em;}</style><h2 class='citeproc-org-bib-h2'>Bibliography</h2>
<div class="csl-bib-body">
  <div class="csl-entry"><a name="citeproc_bib_item_1"></a>Rust, John. 1987. “Optimal Replacement of GMC Bus Engines: An Empirical Model of Harold Zurcher.” <i>Econometrica</i> 55 (5):999–1033. <a href="http://www.jstor.org/stable/1911259">http://www.jstor.org/stable/1911259</a>.</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: September 24th</p>
<p class="author">Author: Gabriel Petrini</p>
<p class="date">Created: 2020-09-22 ter 19:01</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
